2025-05-27 02:15:24,007 INFO    MainThread:1662956 [wandb_setup.py:_flush():67] Current SDK version is 0.19.9
2025-05-27 02:15:24,007 INFO    MainThread:1662956 [wandb_setup.py:_flush():67] Configure stats pid to 1662956
2025-05-27 02:15:24,007 INFO    MainThread:1662956 [wandb_setup.py:_flush():67] Loading settings from /home/jaa/.config/wandb/settings
2025-05-27 02:15:24,007 INFO    MainThread:1662956 [wandb_setup.py:_flush():67] Loading settings from /home/jaa/Work/Prog/BSU/Detectors/mmdetection/wandb/settings
2025-05-27 02:15:24,007 INFO    MainThread:1662956 [wandb_setup.py:_flush():67] Loading settings from environment variables
2025-05-27 02:15:24,007 INFO    MainThread:1662956 [wandb_init.py:setup_run_log_directory():662] Logging user logs to /home/jaa/Work/Prog/BSU/Detectors/work_dirs/CODETR/CODETR_r50_20e_New_custom/20250527_021521/vis_data/wandb/run-20250527_021524-6u52mn19/logs/debug.log
2025-05-27 02:15:24,007 INFO    MainThread:1662956 [wandb_init.py:setup_run_log_directory():663] Logging internal logs to /home/jaa/Work/Prog/BSU/Detectors/work_dirs/CODETR/CODETR_r50_20e_New_custom/20250527_021521/vis_data/wandb/run-20250527_021524-6u52mn19/logs/debug-internal.log
2025-05-27 02:15:24,007 INFO    MainThread:1662956 [wandb_init.py:init():781] calling init triggers
2025-05-27 02:15:24,007 INFO    MainThread:1662956 [wandb_init.py:init():786] wandb.init called with sweep_config: {}
config: {'_wandb': {}}
2025-05-27 02:15:24,007 INFO    MainThread:1662956 [wandb_init.py:init():809] starting backend
2025-05-27 02:15:24,007 INFO    MainThread:1662956 [wandb_init.py:init():813] sending inform_init request
2025-05-27 02:15:24,009 INFO    MainThread:1662956 [backend.py:_multiprocessing_setup():101] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2025-05-27 02:15:24,009 INFO    MainThread:1662956 [wandb_init.py:init():823] backend started and connected
2025-05-27 02:15:24,010 INFO    MainThread:1662956 [wandb_init.py:init():915] updated telemetry
2025-05-27 02:15:24,012 INFO    MainThread:1662956 [wandb_init.py:init():939] communicating run to backend with 90.0 second timeout
2025-05-27 02:15:24,725 INFO    MainThread:1662956 [wandb_init.py:init():1014] starting run threads in backend
2025-05-27 02:15:24,768 INFO    MainThread:1662956 [wandb_run.py:_console_start():2454] atexit reg
2025-05-27 02:15:24,768 INFO    MainThread:1662956 [wandb_run.py:_redirect():2306] redirect: wrap_raw
2025-05-27 02:15:24,768 INFO    MainThread:1662956 [wandb_run.py:_redirect():2371] Wrapping output streams.
2025-05-27 02:15:24,768 INFO    MainThread:1662956 [wandb_run.py:_redirect():2394] Redirects installed.
2025-05-27 02:15:24,769 INFO    MainThread:1662956 [wandb_init.py:init():1056] run started, returning control to user process
2025-05-27 02:15:24,770 INFO    MainThread:1662956 [wandb_run.py:_config_callback():1327] config_cb None None {'HOME': '/home/jaa/Work/Prog/BSU/Detectors', 'MODEL_GROUP': 'transformer', 'MODEL_TYPE': 'CODETR', 'WEIGHT_SIZE': 'r50', 'additions': 'New', 'auto_scale_lr': {'base_batch_size': 8, 'enable': True}, 'backend_args': None, 'batch_augments': [], 'batch_size': 1, 'checkpoint_config': {'interval': 1}, 'custom_imports': {'allow_failed_imports': False, 'imports': ['projects.CODETR.codetr']}, 'data_root': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/', 'dataset_type': 'CocoDataset', 'default_hooks': {'checkpoint': {'_scope_': 'mmdet', 'by_epoch': True, 'interval': 1, 'max_keep_ckpts': 3, 'type': 'CheckpointHook'}, 'early_stopping': {'min_delta': 0.001, 'monitor': 'coco/bbox_mAP', 'patience': 3, 'type': 'EarlyStoppingHook'}, 'logger': {'_scope_': 'mmdet', 'interval': 50, 'log_metric_by_epoch': True, 'type': 'LoggerHook'}, 'param_scheduler': {'_scope_': 'mmdet', 'type': 'ParamSchedulerHook'}, 'sampler_seed': {'_scope_': 'mmdet', 'type': 'DistSamplerSeedHook'}, 'timer': {'_scope_': 'mmdet', 'type': 'IterTimerHook'}, 'visualization': {'_scope_': 'mmdet', 'type': 'DetVisualizationHook'}}, 'default_scope': 'mmdet', 'deterministic': True, 'env_cfg': {'cudnn_benchmark': False, 'dist_cfg': {'backend': 'nccl'}, 'mp_cfg': {'mp_start_method': 'fork', 'opencv_num_threads': 0}}, 'evaluation': {'interval': 1, 'metric': 'bbox'}, 'experiment': 'CODETR_r50_20e_New_custom', 'image_size': [1280, 1280], 'launcher': 'none', 'load_from': '/home/jaa/Work/Prog/BSU/Detectors/work_dirs/CODETR/CODETR_r50_20e_New_custom/epoch_18.pth', 'load_pipeline': [{'backend_args': None, 'type': 'LoadImageFromFile'}, {'type': 'LoadAnnotations', 'with_bbox': True}, {'prob': 0.5, 'type': 'RandomFlip'}, {'level': 2, 'prob': 0.3, 'type': 'Rotate'}, {'keep_empty': False, 'min_gt_bbox_wh': [16, 16], 'type': 'FilterAnnotations'}, {'keep_ratio': True, 'scale': [1280, 1280], 'type': 'Resize'}], 'log_level': 'INFO', 'log_processor': {'_scope_': 'mmdet', 'by_epoch': True, 'type': 'LogProcessor', 'window_size': 50}, 'loss_lambda': 2.0, 'max_epochs': 12, 'max_iters': 270000, 'metainfo': {'classes': ['cow'], 'palette': [[220, 20, 60]]}, 'model': {'backbone': {'depth': 50, 'frozen_stages': 1, 'init_cfg': {'checkpoint': 'torchvision://resnet50', 'type': 'Pretrained'}, 'norm_cfg': {'requires_grad': False, 'type': 'BN'}, 'norm_eval': True, 'num_stages': 4, 'out_indices': [0, 1, 2, 3], 'style': 'pytorch', 'type': 'ResNet'}, 'bbox_head': [{'anchor_generator': {'octave_base_scale': 8, 'ratios': [1.0], 'scales_per_octave': 1, 'strides': [4, 8, 16, 32, 64, 128], 'type': 'AnchorGenerator'}, 'bbox_coder': {'target_means': [0.0, 0.0, 0.0, 0.0], 'target_stds': [0.1, 0.1, 0.2, 0.2], 'type': 'DeltaXYWHBBoxCoder'}, 'feat_channels': 256, 'in_channels': 256, 'loss_bbox': {'loss_weight': 24.0, 'type': 'GIoULoss'}, 'loss_centerness': {'loss_weight': 12.0, 'type': 'CrossEntropyLoss', 'use_sigmoid': True}, 'loss_cls': {'alpha': 0.25, 'gamma': 2.0, 'loss_weight': 12.0, 'type': 'FocalLoss', 'use_sigmoid': True}, 'num_classes': 1, 'stacked_convs': 1, 'type': 'CoATSSHead'}], 'data_preprocessor': {'batch_augments': [], 'bgr_to_rgb': True, 'mean': [123.675, 116.28, 103.53], 'pad_mask': True, 'std': [58.395, 57.12, 57.375], 'type': 'DetDataPreprocessor'}, 'eval_module': 'detr', 'neck': {'act_cfg': None, 'in_channels': [256, 512, 1024, 2048], 'kernel_size': 1, 'norm_cfg': {'num_groups': 32, 'type': 'GN'}, 'num_outs': 5, 'out_channels': 256, 'type': 'ChannelMapper'}, 'query_head': {'as_two_stage': True, 'dn_cfg': {'box_noise_scale': 1.0, 'group_cfg': {'dynamic': True, 'num_dn_queries': 100, 'num_groups': None}, 'label_noise_scale': 0.5}, 'in_channels': 2048, 'loss_bbox': {'loss_weight': 5.0, 'type': 'L1Loss'}, 'loss_cls': {'beta': 2.0, 'loss_weight': 1.0, 'type': 'QualityFocalLoss', 'use_sigmoid': True}, 'loss_iou': {'loss_weight': 2.0, 'type': 'GIoULoss'}, 'num_classes': 1, 'num_query': 900, 'positional_encoding': {'normalize': True, 'num_feats': 128, 'temperature': 20, 'type': 'SinePositionalEncoding'}, 'transformer': {'decoder': {'num_layers': 6, 'return_intermediate': True, 'transformerlayers': {'attn_cfgs': [{'dropout': 0.0, 'embed_dims': 256, 'num_heads': 8, 'type': 'MultiheadAttention'}, {'dropout': 0.0, 'embed_dims': 256, 'num_levels': 5, 'type': 'MultiScaleDeformableAttention'}], 'feedforward_channels': 2048, 'ffn_dropout': 0.0, 'operation_order': ['self_attn', 'norm', 'cross_attn', 'norm', 'ffn', 'norm'], 'type': 'DetrTransformerDecoderLayer'}, 'type': 'DinoTransformerDecoder'}, 'encoder': {'num_layers': 6, 'transformerlayers': {'attn_cfgs': {'dropout': 0.0, 'embed_dims': 256, 'num_levels': 5, 'type': 'MultiScaleDeformableAttention'}, 'feedforward_channels': 2048, 'ffn_dropout': 0.0, 'operation_order': ['self_attn', 'norm', 'ffn', 'norm'], 'type': 'BaseTransformerLayer'}, 'type': 'DetrTransformerEncoder', 'with_cp': 4}, 'num_co_heads': 2, 'num_feature_levels': 5, 'type': 'CoDinoTransformer', 'with_coord_feat': False}, 'type': 'CoDINOHead'}, 'roi_head': [{'bbox_head': {'bbox_coder': {'target_means': [0.0, 0.0, 0.0, 0.0], 'target_stds': [0.1, 0.1, 0.2, 0.2], 'type': 'DeltaXYWHBBoxCoder'}, 'fc_out_channels': 1024, 'in_channels': 256, 'loss_bbox': {'loss_weight': 120.0, 'type': 'GIoULoss'}, 'loss_cls': {'loss_weight': 12.0, 'type': 'CrossEntropyLoss', 'use_sigmoid': False}, 'num_classes': 1, 'reg_class_agnostic': False, 'reg_decoded_bbox': True, 'roi_feat_size': 7, 'type': 'Shared2FCBBoxHead'}, 'bbox_roi_extractor': {'featmap_strides': [4, 8, 16, 32, 64], 'finest_scale': 56, 'out_channels': 256, 'roi_layer': {'output_size': 7, 'sampling_ratio': 0, 'type': 'RoIAlign'}, 'type': 'SingleRoIExtractor'}, 'type': 'CoStandardRoIHead'}], 'rpn_head': {'anchor_generator': {'octave_base_scale': 4, 'ratios': [0.5, 1.0, 2.0], 'scales_per_octave': 3, 'strides': [4, 8, 16, 32, 64, 128], 'type': 'AnchorGenerator'}, 'bbox_coder': {'target_means': [0.0, 0.0, 0.0, 0.0], 'target_stds': [1.0, 1.0, 1.0, 1.0], 'type': 'DeltaXYWHBBoxCoder'}, 'feat_channels': 256, 'in_channels': 256, 'loss_bbox': {'loss_weight': 12.0, 'type': 'L1Loss'}, 'loss_cls': {'loss_weight': 12.0, 'type': 'CrossEntropyLoss', 'use_sigmoid': True}, 'type': 'RPNHead'}, 'test_cfg': [{'max_per_img': 300, 'nms': {'iou_threshold': 0.8, 'type': 'soft_nms'}}, {'rcnn': {'max_per_img': 100, 'nms': {'iou_threshold': 0.5, 'type': 'nms'}, 'score_thr': 0.0}, 'rpn': {'max_per_img': 1000, 'min_bbox_size': 0, 'nms': {'iou_threshold': 0.7, 'type': 'nms'}, 'nms_pre': 1000}}, {'max_per_img': 100, 'min_bbox_size': 0, 'nms': {'iou_threshold': 0.6, 'type': 'nms'}, 'nms_pre': 1000, 'score_thr': 0.0}], 'train_cfg': [{'assigner': {'match_costs': [{'type': 'FocalLossCost', 'weight': 2.0}, {'box_format': 'xywh', 'type': 'BBoxL1Cost', 'weight': 5.0}, {'iou_mode': 'giou', 'type': 'IoUCost', 'weight': 2.0}], 'type': 'HungarianAssigner'}}, {'rcnn': {'assigner': {'ignore_iof_thr': -1, 'match_low_quality': False, 'min_pos_iou': 0.5, 'neg_iou_thr': 0.5, 'pos_iou_thr': 0.5, 'type': 'MaxIoUAssigner'}, 'debug': False, 'pos_weight': -1, 'sampler': {'add_gt_as_proposals': True, 'neg_pos_ub': -1, 'num': 512, 'pos_fraction': 0.25, 'type': 'RandomSampler'}}, 'rpn': {'allowed_border': -1, 'assigner': {'ignore_iof_thr': -1, 'match_low_quality': True, 'min_pos_iou': 0.3, 'neg_iou_thr': 0.3, 'pos_iou_thr': 0.7, 'type': 'MaxIoUAssigner'}, 'debug': False, 'pos_weight': -1, 'sampler': {'add_gt_as_proposals': False, 'neg_pos_ub': -1, 'num': 256, 'pos_fraction': 0.5, 'type': 'RandomSampler'}}, 'rpn_proposal': {'max_per_img': 1000, 'min_bbox_size': 0, 'nms': {'iou_threshold': 0.7, 'type': 'nms'}, 'nms_pre': 4000}}, {'allowed_border': -1, 'assigner': {'topk': 9, 'type': 'ATSSAssigner'}, 'debug': False, 'pos_weight': -1}], 'type': 'CoDETR', 'use_lsj': True}, 'model_backbone': {'frozen_stages': 1, 'norm_eval': True}, 'model_bbox_head': {'bbox_head': [{'anchor_generator': {'octave_base_scale': 8, 'ratios': [1.0], 'scales_per_octave': 1, 'strides': [4, 8, 16, 32, 64, 128], 'type': 'AnchorGenerator'}, 'bbox_coder': {'target_means': [0.0, 0.0, 0.0, 0.0], 'target_stds': [0.1, 0.1, 0.2, 0.2], 'type': 'DeltaXYWHBBoxCoder'}, 'feat_channels': 256, 'in_channels': 256, 'loss_bbox': {'loss_weight': 24.0, 'type': 'GIoULoss'}, 'loss_centerness': {'loss_weight': 12.0, 'type': 'CrossEntropyLoss', 'use_sigmoid': True}, 'loss_cls': {'alpha': 0.25, 'gamma': 2.0, 'loss_weight': 12.0, 'type': 'FocalLoss', 'use_sigmoid': True}, 'num_classes': 1, 'stacked_convs': 1, 'type': 'CoATSSHead'}]}, 'model_roi_head': {}, 'num_classes': 1, 'num_dec_layer': 6, 'num_epochs': 20, 'num_workers': 6, 'optim_wrapper': {'clip_grad': {'max_norm': 0.1, 'norm_type': 2}, 'optimizer': {'lr': 2.5e-05, 'type': 'AdamW', 'weight_decay': 0.05}, 'paramwise_cfg': {'custom_keys': {'backbone': {'lr_mult': 0.1}}}, 'type': 'OptimWrapper'}, 'param_scheduler': [{'begin': 0, 'by_epoch': False, 'end': 500, 'start_factor': 0.05, 'type': 'LinearLR'}, {'T_max': 12, 'begin': 0, 'by_epoch': True, 'end': 20, 'eta_min': 1e-06, 'type': 'CosineAnnealingLR'}], 'resume': True, 'seed': 42, 'test_cfg': {'_scope_': 'mmdet', 'type': 'TestLoop'}, 'test_dataloader': {'batch_size': 1, 'dataset': {'_scope_': 'mmdet', 'ann_file': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/test_coco.json', 'backend_args': None, 'data_prefix': {'img': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/test/images'}, 'data_root': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/', 'pipeline': [{'backend_args': None, 'type': 'LoadImageFromFile'}, {'type': 'LoadAnnotations', 'with_bbox': True}, {'keep_empty': False, 'min_gt_bbox_wh': [16, 16], 'type': 'FilterAnnotations'}, {'keep_ratio': True, 'scale': [1280, 1280], 'type': 'Resize'}, {'meta_keys': ['img_id', 'img_path', 'ori_shape', 'img_shape', 'scale_factor'], 'type': 'PackDetInputs'}], 'test_mode': True, 'type': 'CocoDataset'}, 'drop_last': False, 'num_workers': 6, 'persistent_workers': True, 'sampler': {'_scope_': 'mmdet', 'shuffle': False, 'type': 'DefaultSampler'}}, 'test_evaluator': {'_scope_': 'mmdet', 'ann_file': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/test_coco.json', 'backend_args': None, 'format_only': True, 'metric': 'bbox', 'outfile_prefix': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/test/images', 'type': 'CocoMetric'}, 'test_pipeline': [{'backend_args': None, 'type': 'LoadImageFromFile'}, {'type': 'LoadAnnotations', 'with_bbox': True}, {'keep_empty': False, 'min_gt_bbox_wh': [16, 16], 'type': 'FilterAnnotations'}, {'keep_ratio': True, 'scale': [1280, 1280], 'type': 'Resize'}, {'meta_keys': ['img_id', 'img_path', 'ori_shape', 'img_shape', 'scale_factor'], 'type': 'PackDetInputs'}], 'train_cfg': {'max_epochs': 20, 'type': 'EpochBasedTrainLoop', 'val_interval': 1}, 'train_dataloader': {'batch_size': 1, 'dataset': {'dataset': {'ann_file': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/train_coco.json', 'backend_args': None, 'data_prefix': {'img': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/train/images'}, 'data_root': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/', 'metainfo': {'classes': ['cow'], 'palette': [[220, 20, 60]]}, 'pipeline': [{'backend_args': None, 'type': 'LoadImageFromFile'}, {'type': 'LoadAnnotations', 'with_bbox': True}, {'prob': 0.5, 'type': 'RandomFlip'}, {'level': 2, 'prob': 0.3, 'type': 'Rotate'}, {'keep_empty': False, 'min_gt_bbox_wh': [16, 16], 'type': 'FilterAnnotations'}, {'keep_ratio': True, 'scale': [1280, 1280], 'type': 'Resize'}], 'type': 'CocoDataset'}, 'pipeline': [{'type': 'PackDetInputs'}], 'type': 'MultiImageMixDataset'}, 'num_workers': 2, 'persistent_workers': True, 'sampler': {'_scope_': 'mmdet', 'shuffle': True, 'type': 'DefaultSampler'}}, 'train_pipeline': [{'type': 'PackDetInputs'}], 'val_cfg': {'_scope_': 'mmdet', 'type': 'ValLoop'}, 'val_dataloader': {'batch_size': 1, 'dataset': {'_scope_': 'mmdet', 'ann_file': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/valid_coco.json', 'backend_args': None, 'data_prefix': {'img': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/valid/images'}, 'data_root': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/', 'metainfo': {'classes': ['cow'], 'palette': [[220, 20, 60]]}, 'pipeline': [{'backend_args': None, 'type': 'LoadImageFromFile'}, {'type': 'LoadAnnotations', 'with_bbox': True}, {'keep_empty': False, 'min_gt_bbox_wh': [16, 16], 'type': 'FilterAnnotations'}, {'keep_ratio': True, 'scale': [1280, 1280], 'type': 'Resize'}, {'meta_keys': ['img_id', 'img_path', 'ori_shape', 'img_shape', 'scale_factor'], 'type': 'PackDetInputs'}], 'test_mode': True, 'type': 'CocoDataset'}, 'drop_last': False, 'num_workers': 6, 'persistent_workers': True, 'sampler': {'_scope_': 'mmdet', 'shuffle': False, 'type': 'DefaultSampler'}}, 'val_evaluator': {'_scope_': 'mmdet', 'ann_file': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch//valid_coco.json', 'backend_args': None, 'format_only': False, 'metric': 'bbox', 'type': 'CocoMetric'}, 'vis_backends': [{'init_kwargs': {'group': 'transformer', 'name': 'CODETR_r50_20e_1b_New', 'project': 'Сomparison of detectors'}, 'type': 'WandbVisBackend'}], 'visualizer': {'_scope_': 'mmdet', 'name': 'visualizer', 'type': 'Visualizer', 'vis_backends': [{'init_kwargs': {'group': 'transformer', 'name': 'CODETR_r50_20e_1b_New', 'project': 'Сomparison of detectors'}, 'type': 'WandbVisBackend'}]}, 'weights': 'co_dino_5scale_lsj_r50_3x_coco-fe5a6829.pth', 'work_dir': '/home/jaa/Work/Prog/BSU/Detectors/work_dirs/CODETR/CODETR_r50_20e_New_custom/'}
2025-05-27 02:15:29,254 INFO    MsgRouterThr:1662956 [mailbox.py:close():129] [no run ID] Closing mailbox, abandoning 2 handles.
