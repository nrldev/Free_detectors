2025-05-12 08:19:29,920 INFO    MainThread:718187 [wandb_setup.py:_flush():67] Current SDK version is 0.19.9
2025-05-12 08:19:29,920 INFO    MainThread:718187 [wandb_setup.py:_flush():67] Configure stats pid to 718187
2025-05-12 08:19:29,920 INFO    MainThread:718187 [wandb_setup.py:_flush():67] Loading settings from /home/jaa/.config/wandb/settings
2025-05-12 08:19:29,920 INFO    MainThread:718187 [wandb_setup.py:_flush():67] Loading settings from /home/jaa/Work/Prog/BSU/Detectors/mmdetection/wandb/settings
2025-05-12 08:19:29,920 INFO    MainThread:718187 [wandb_setup.py:_flush():67] Loading settings from environment variables
2025-05-12 08:19:29,920 INFO    MainThread:718187 [wandb_init.py:setup_run_log_directory():662] Logging user logs to /home/jaa/Work/Prog/BSU/Detectors/work_dirs/RTMDet/RTMDet_m_30e_new1_custom/20250512_081928/vis_data/wandb/run-20250512_081929-8q1867wk/logs/debug.log
2025-05-12 08:19:29,920 INFO    MainThread:718187 [wandb_init.py:setup_run_log_directory():663] Logging internal logs to /home/jaa/Work/Prog/BSU/Detectors/work_dirs/RTMDet/RTMDet_m_30e_new1_custom/20250512_081928/vis_data/wandb/run-20250512_081929-8q1867wk/logs/debug-internal.log
2025-05-12 08:19:29,920 INFO    MainThread:718187 [wandb_init.py:init():781] calling init triggers
2025-05-12 08:19:29,920 INFO    MainThread:718187 [wandb_init.py:init():786] wandb.init called with sweep_config: {}
config: {'_wandb': {}}
2025-05-12 08:19:29,920 INFO    MainThread:718187 [wandb_init.py:init():809] starting backend
2025-05-12 08:19:29,920 INFO    MainThread:718187 [wandb_init.py:init():813] sending inform_init request
2025-05-12 08:19:29,922 INFO    MainThread:718187 [backend.py:_multiprocessing_setup():101] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2025-05-12 08:19:29,922 INFO    MainThread:718187 [wandb_init.py:init():823] backend started and connected
2025-05-12 08:19:29,923 INFO    MainThread:718187 [wandb_init.py:init():915] updated telemetry
2025-05-12 08:19:29,925 INFO    MainThread:718187 [wandb_init.py:init():939] communicating run to backend with 90.0 second timeout
2025-05-12 08:19:30,688 INFO    MainThread:718187 [wandb_init.py:init():1014] starting run threads in backend
2025-05-12 08:19:30,731 INFO    MainThread:718187 [wandb_run.py:_console_start():2454] atexit reg
2025-05-12 08:19:30,731 INFO    MainThread:718187 [wandb_run.py:_redirect():2306] redirect: wrap_raw
2025-05-12 08:19:30,731 INFO    MainThread:718187 [wandb_run.py:_redirect():2371] Wrapping output streams.
2025-05-12 08:19:30,731 INFO    MainThread:718187 [wandb_run.py:_redirect():2394] Redirects installed.
2025-05-12 08:19:30,732 INFO    MainThread:718187 [wandb_init.py:init():1056] run started, returning control to user process
2025-05-12 08:19:30,733 INFO    MainThread:718187 [wandb_run.py:_config_callback():1327] config_cb None None {'train_cfg': {'type': 'EpochBasedTrainLoop', 'max_epochs': 30, 'val_interval': 1, 'dynamic_intervals': [[280, 1]]}, 'val_cfg': {'type': 'ValLoop'}, 'test_cfg': {'type': 'TestLoop'}, 'param_scheduler': [{'begin': 0, 'by_epoch': False, 'end': 500, 'start_factor': 0.001, 'type': 'LinearLR'}, {'begin': 0, 'by_epoch': True, 'end': 12, 'gamma': 0.1, 'milestones': [7, 14], 'type': 'MultiStepLR'}, {'T_max': 10, 'begin': 0, 'by_epoch': True, 'end': 10, 'type': 'CosineAnnealingLR'}], 'optim_wrapper': {'type': 'OptimWrapper', 'optimizer': {'type': 'SGD', 'lr': 0.0025, 'weight_decay': 0.0005, 'momentum': 0.9}, 'paramwise_cfg': {'norm_decay_mult': 0, 'bias_decay_mult': 0, 'bypass_duplicate': True}}, 'auto_scale_lr': {'enable': False, 'base_batch_size': 6}, 'dataset_type': 'CocoDataset', 'data_root': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/', 'backend_args': None, 'train_pipeline': [{'type': 'LoadImageFromFile', 'backend_args': None}, {'type': 'LoadAnnotations', 'with_bbox': True}, {'type': 'RandomFlip', 'prob': 0.5}, {'type': 'Rotate', 'level': 2, 'prob': 0.3}, {'type': 'FilterAnnotations', 'min_gt_bbox_wh': [16, 16], 'keep_empty': False}, {'type': 'Resize', 'scale': [1280, 1280], 'keep_ratio': True}, {'type': 'PackDetInputs'}], 'test_pipeline': [{'type': 'LoadImageFromFile', 'backend_args': None}, {'type': 'LoadAnnotations', 'with_bbox': True}, {'type': 'FilterAnnotations', 'min_gt_bbox_wh': [16, 16], 'keep_empty': False}, {'type': 'Resize', 'scale': [1280, 1280], 'keep_ratio': True}, {'type': 'PackDetInputs', 'meta_keys': ['img_id', 'img_path', 'ori_shape', 'img_shape', 'scale_factor']}], 'train_dataloader': {'batch_size': 6, 'num_workers': 6, 'persistent_workers': True, 'sampler': {'type': 'DefaultSampler', 'shuffle': True}, 'batch_sampler': None, 'dataset': {'type': 'CocoDataset', 'data_root': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/', 'ann_file': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/train_coco.json', 'data_prefix': {'img': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/train/images'}, 'filter_cfg': {'filter_empty_gt': True, 'min_size': 32}, 'pipeline': [{'type': 'LoadImageFromFile', 'backend_args': None}, {'type': 'LoadAnnotations', 'with_bbox': True}, {'type': 'RandomFlip', 'prob': 0.5}, {'type': 'Rotate', 'level': 2, 'prob': 0.3}, {'type': 'FilterAnnotations', 'min_gt_bbox_wh': [16, 16], 'keep_empty': False}, {'type': 'Resize', 'scale': [1280, 1280], 'keep_ratio': True}, {'type': 'PackDetInputs'}], 'backend_args': None, 'metainfo': {'classes': ['cow'], 'palette': [[220, 20, 60]]}}, 'pin_memory': True}, 'val_dataloader': {'batch_size': 6, 'num_workers': 6, 'persistent_workers': True, 'drop_last': False, 'sampler': {'type': 'DefaultSampler', 'shuffle': False}, 'dataset': {'type': 'CocoDataset', 'data_root': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/', 'ann_file': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/valid_coco.json', 'data_prefix': {'img': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/valid/images'}, 'test_mode': True, 'pipeline': [{'type': 'LoadImageFromFile', 'backend_args': None}, {'type': 'LoadAnnotations', 'with_bbox': True}, {'type': 'FilterAnnotations', 'min_gt_bbox_wh': [16, 16], 'keep_empty': False}, {'type': 'Resize', 'scale': [1280, 1280], 'keep_ratio': True}, {'type': 'PackDetInputs', 'meta_keys': ['img_id', 'img_path', 'ori_shape', 'img_shape', 'scale_factor']}], 'backend_args': None, 'metainfo': {'classes': ['cow'], 'palette': [[220, 20, 60]]}}}, 'test_dataloader': {'batch_size': 6, 'num_workers': 6, 'persistent_workers': True, 'drop_last': False, 'sampler': {'type': 'DefaultSampler', 'shuffle': False}, 'dataset': {'type': 'CocoDataset', 'data_root': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/', 'ann_file': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/test_coco.json', 'data_prefix': {'img': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/test/images'}, 'test_mode': True, 'pipeline': [{'type': 'LoadImageFromFile', 'backend_args': None}, {'type': 'LoadAnnotations', 'with_bbox': True}, {'type': 'FilterAnnotations', 'min_gt_bbox_wh': [16, 16], 'keep_empty': False}, {'type': 'Resize', 'scale': [1280, 1280], 'keep_ratio': True}, {'type': 'PackDetInputs', 'meta_keys': ['img_id', 'img_path', 'ori_shape', 'img_shape', 'scale_factor']}], 'backend_args': None}}, 'val_evaluator': {'type': 'CocoMetric', 'ann_file': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch//valid_coco.json', 'metric': 'bbox', 'format_only': False, 'backend_args': None, 'proposal_nums': [100, 1, 10]}, 'test_evaluator': {'type': 'CocoMetric', 'ann_file': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/test_coco.json', 'metric': 'bbox', 'format_only': True, 'backend_args': None, 'proposal_nums': [100, 1, 10], 'outfile_prefix': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/test/images'}, 'tta_model': {'type': 'DetTTAModel', 'tta_cfg': {'nms': {'type': 'nms', 'iou_threshold': 0.6}, 'max_per_img': 100}}, 'img_scales': [[640, 640], [320, 320], [960, 960]], 'tta_pipeline': [{'type': 'LoadImageFromFile', 'backend_args': None}, {'type': 'TestTimeAug', 'transforms': [[{'type': 'Resize', 'scale': [640, 640], 'keep_ratio': True}, {'type': 'Resize', 'scale': [320, 320], 'keep_ratio': True}, {'type': 'Resize', 'scale': [960, 960], 'keep_ratio': True}], [{'type': 'RandomFlip', 'prob': 1.0}, {'type': 'RandomFlip', 'prob': 0.0}], [{'type': 'Pad', 'size': [960, 960], 'pad_val': {'img': [114, 114, 114]}}], [{'type': 'LoadAnnotations', 'with_bbox': True}], [{'type': 'PackDetInputs', 'meta_keys': ['img_id', 'img_path', 'ori_shape', 'img_shape', 'scale_factor', 'flip', 'flip_direction']}]]}], 'default_hooks': {'timer': {'type': 'IterTimerHook'}, 'logger': {'type': 'LoggerHook', 'interval': 50, 'log_metric_by_epoch': True}, 'param_scheduler': {'type': 'ParamSchedulerHook'}, 'checkpoint': {'type': 'CheckpointHook', 'interval': 1, 'max_keep_ckpts': 3}, 'sampler_seed': {'type': 'DistSamplerSeedHook'}, 'visualization': {'type': 'DetVisualizationHook'}, 'early_stopping': {'type': 'EarlyStoppingHook', 'monitor': 'coco/bbox_mAP', 'min_delta': 0.001, 'patience': 3}}, 'env_cfg': {'cudnn_benchmark': False, 'mp_cfg': {'mp_start_method': 'fork', 'opencv_num_threads': 0}, 'dist_cfg': {'backend': 'nccl'}}, 'vis_backends': [{'type': 'WandbVisBackend', 'init_kwargs': {'project': 'Сomparison of detectors', 'group': 'yolo-like', 'name': 'RTMDet_m_30e_6b_new1'}}], 'visualizer': {'type': 'Visualizer', 'vis_backends': [{'type': 'WandbVisBackend', 'init_kwargs': {'project': 'Сomparison of detectors', 'group': 'yolo-like', 'name': 'RTMDet_m_30e_6b_new1'}}]}, 'log_processor': {'type': 'LogProcessor', 'window_size': 50, 'by_epoch': True}, 'log_level': 'INFO', 'load_from': '/home/jaa/Work/Prog/BSU/Detectors/models/RTMDet/rtmdet_m_8xb32-300e_coco_20220719_112220-229f527c.pth', 'resume': False, 'metainfo': {'classes': ['cow'], 'palette': [[220, 20, 60]]}, 'custom_imports': {'imports': ['custom_hooks'], 'allow_failed_imports': False}, 'custom_hooks': [{'type': 'CustomFreezeHook', 'unfreeze_epoch': 5}], 'model': {'type': 'RTMDet', 'data_preprocessor': {'type': 'DetDataPreprocessor', 'mean': [103.53, 116.28, 123.675], 'std': [57.375, 57.12, 58.395], 'bgr_to_rgb': False, 'batch_augments': None}, 'backbone': {'type': 'CSPNeXt', 'arch': 'P5', 'expand_ratio': 0.5, 'deepen_factor': 0.67, 'widen_factor': 0.75, 'channel_attention': True, 'norm_cfg': {'type': 'SyncBN'}, 'act_cfg': {'type': 'SiLU', 'inplace': True}}, 'neck': {'type': 'CSPNeXtPAFPN', 'in_channels': [192, 384, 768], 'out_channels': 192, 'num_csp_blocks': 2, 'expand_ratio': 0.5, 'norm_cfg': {'type': 'SyncBN'}, 'act_cfg': {'type': 'SiLU', 'inplace': True}}, 'bbox_head': {'type': 'RTMDetSepBNHead', 'num_classes': 1, 'in_channels': 192, 'stacked_convs': 2, 'feat_channels': 192, 'anchor_generator': {'type': 'MlvlPointGenerator', 'offset': 0, 'strides': [8, 16, 32]}, 'bbox_coder': {'type': 'DistancePointBBoxCoder'}, 'loss_cls': {'type': 'QualityFocalLoss', 'use_sigmoid': True, 'beta': 2.0, 'loss_weight': 1.0}, 'loss_bbox': {'type': 'GIoULoss', 'loss_weight': 2.0}, 'with_objectness': False, 'exp_on_reg': True, 'share_conv': True, 'pred_kernel_size': 1, 'norm_cfg': {'type': 'SyncBN'}, 'act_cfg': {'type': 'SiLU', 'inplace': True}}, 'train_cfg': {'assigner': {'type': 'DynamicSoftLabelAssigner', 'topk': 13}, 'allowed_border': -1, 'pos_weight': -1, 'debug': False}, 'test_cfg': {'nms_pre': 30000, 'min_bbox_size': 0, 'score_thr': 0.001, 'nms': {'type': 'nms', 'iou_threshold': 0.65}, 'max_per_img': 300}}, 'train_pipeline_stage2': [{'type': 'LoadImageFromFile', 'backend_args': None}, {'type': 'LoadAnnotations', 'with_bbox': True}, {'type': 'RandomResize', 'scale': [640, 640], 'ratio_range': [0.1, 2.0], 'keep_ratio': True}, {'type': 'RandomCrop', 'crop_size': [640, 640]}, {'type': 'YOLOXHSVRandomAug'}, {'type': 'RandomFlip', 'prob': 0.5}, {'type': 'Pad', 'size': [640, 640], 'pad_val': {'img': [114, 114, 114]}}, {'type': 'PackDetInputs'}], 'max_epochs': 300, 'stage2_num_epochs': 20, 'base_lr': 0.004, 'interval': 10, 'default_scope': 'mmdet', 'seed': 42, 'deterministic': True, 'MODEL_GROUP': 'yolo-like', 'MODEL_TYPE': 'RTMDet', 'WEIGHT_SIZE': 'm', 'HOME': '/home/jaa/Work/Prog/BSU/Detectors', 'num_workers': 6, 'num_classes': 1, 'batch_size': 6, 'num_epochs': 30, 'additions': 'new1', 'experiment': 'RTMDet_m_30e_new1_custom', 'weights': 'rtmdet_m_8xb32-300e_coco_20220719_112220-229f527c.pth', 'work_dir': '/home/jaa/Work/Prog/BSU/Detectors/work_dirs/RTMDet/RTMDet_m_30e_new1_custom/', 'checkpoint_config': {'interval': 1}, 'evaluation': {'interval': 1, 'metric': 'bbox'}, 'launcher': 'none'}
2025-05-12 08:19:39,448 INFO    MsgRouterThr:718187 [mailbox.py:close():129] [no run ID] Closing mailbox, abandoning 1 handles.
