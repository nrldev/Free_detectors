2025-05-14 21:36:03,523 INFO    MainThread:128635 [wandb_setup.py:_flush():67] Current SDK version is 0.19.9
2025-05-14 21:36:03,523 INFO    MainThread:128635 [wandb_setup.py:_flush():67] Configure stats pid to 128635
2025-05-14 21:36:03,523 INFO    MainThread:128635 [wandb_setup.py:_flush():67] Loading settings from /home/jaa/.config/wandb/settings
2025-05-14 21:36:03,523 INFO    MainThread:128635 [wandb_setup.py:_flush():67] Loading settings from /home/jaa/Work/Prog/BSU/Detectors/mmdetection/wandb/settings
2025-05-14 21:36:03,523 INFO    MainThread:128635 [wandb_setup.py:_flush():67] Loading settings from environment variables
2025-05-14 21:36:03,523 INFO    MainThread:128635 [wandb_init.py:setup_run_log_directory():662] Logging user logs to /home/jaa/Work/Prog/BSU/Detectors/work_dirs/RTDETR/RTDETR_r50_36e_5b_New_custom/20250514_213601/vis_data/wandb/run-20250514_213603-g3hlkuf7/logs/debug.log
2025-05-14 21:36:03,523 INFO    MainThread:128635 [wandb_init.py:setup_run_log_directory():663] Logging internal logs to /home/jaa/Work/Prog/BSU/Detectors/work_dirs/RTDETR/RTDETR_r50_36e_5b_New_custom/20250514_213601/vis_data/wandb/run-20250514_213603-g3hlkuf7/logs/debug-internal.log
2025-05-14 21:36:03,523 INFO    MainThread:128635 [wandb_init.py:init():781] calling init triggers
2025-05-14 21:36:03,523 INFO    MainThread:128635 [wandb_init.py:init():786] wandb.init called with sweep_config: {}
config: {'_wandb': {}}
2025-05-14 21:36:03,523 INFO    MainThread:128635 [wandb_init.py:init():809] starting backend
2025-05-14 21:36:03,523 INFO    MainThread:128635 [wandb_init.py:init():813] sending inform_init request
2025-05-14 21:36:03,525 INFO    MainThread:128635 [backend.py:_multiprocessing_setup():101] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2025-05-14 21:36:03,525 INFO    MainThread:128635 [wandb_init.py:init():823] backend started and connected
2025-05-14 21:36:03,526 INFO    MainThread:128635 [wandb_init.py:init():915] updated telemetry
2025-05-14 21:36:03,528 INFO    MainThread:128635 [wandb_init.py:init():939] communicating run to backend with 90.0 second timeout
2025-05-14 21:36:04,333 INFO    MainThread:128635 [wandb_init.py:init():1014] starting run threads in backend
2025-05-14 21:36:04,375 INFO    MainThread:128635 [wandb_run.py:_console_start():2454] atexit reg
2025-05-14 21:36:04,375 INFO    MainThread:128635 [wandb_run.py:_redirect():2306] redirect: wrap_raw
2025-05-14 21:36:04,375 INFO    MainThread:128635 [wandb_run.py:_redirect():2371] Wrapping output streams.
2025-05-14 21:36:04,375 INFO    MainThread:128635 [wandb_run.py:_redirect():2394] Redirects installed.
2025-05-14 21:36:04,375 INFO    MainThread:128635 [wandb_init.py:init():1056] run started, returning control to user process
2025-05-14 21:36:04,376 INFO    MainThread:128635 [wandb_run.py:_config_callback():1327] config_cb None None {'dataset_type': 'CocoDataset', 'data_root': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/', 'backend_args': None, 'train_pipeline': [{'type': 'LoadImageFromFile', 'backend_args': None}, {'type': 'LoadAnnotations', 'with_bbox': True}, {'type': 'RandomFlip', 'prob': 0.5}, {'type': 'Rotate', 'level': 2, 'prob': 0.3}, {'type': 'FilterAnnotations', 'min_gt_bbox_wh': [16, 16], 'keep_empty': False}, {'type': 'Resize', 'scale': [1280, 1280], 'keep_ratio': True}, {'type': 'PackDetInputs'}], 'test_pipeline': [{'type': 'LoadImageFromFile', 'backend_args': None}, {'type': 'LoadAnnotations', 'with_bbox': True}, {'type': 'FilterAnnotations', 'min_gt_bbox_wh': [16, 16], 'keep_empty': False}, {'type': 'Resize', 'scale': [1280, 1280], 'keep_ratio': True}, {'type': 'PackDetInputs', 'meta_keys': ['img_id', 'img_path', 'ori_shape', 'img_shape', 'scale_factor']}], 'train_dataloader': {'batch_size': 5, 'num_workers': 6, 'persistent_workers': True, 'sampler': {'type': 'DefaultSampler', 'shuffle': True}, 'batch_sampler': {'type': 'AspectRatioBatchSampler'}, 'dataset': {'type': 'CocoDataset', 'data_root': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/', 'ann_file': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/train_coco.json', 'data_prefix': {'img': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/train/images'}, 'filter_cfg': {'filter_empty_gt': False, 'min_size': 32}, 'pipeline': [{'type': 'LoadImageFromFile', 'backend_args': None}, {'type': 'LoadAnnotations', 'with_bbox': True}, {'type': 'RandomFlip', 'prob': 0.5}, {'type': 'Rotate', 'level': 2, 'prob': 0.3}, {'type': 'FilterAnnotations', 'min_gt_bbox_wh': [16, 16], 'keep_empty': False}, {'type': 'Resize', 'scale': [1280, 1280], 'keep_ratio': True}, {'type': 'PackDetInputs'}], 'backend_args': None, 'metainfo': {'classes': ['cow'], 'palette': [[220, 20, 60]]}}}, 'val_dataloader': {'batch_size': 5, 'num_workers': 6, 'persistent_workers': True, 'drop_last': False, 'sampler': {'type': 'DefaultSampler', 'shuffle': False}, 'dataset': {'type': 'CocoDataset', 'data_root': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/', 'ann_file': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/valid_coco.json', 'data_prefix': {'img': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/valid/images'}, 'test_mode': True, 'pipeline': [{'type': 'LoadImageFromFile', 'backend_args': None}, {'type': 'LoadAnnotations', 'with_bbox': True}, {'type': 'FilterAnnotations', 'min_gt_bbox_wh': [16, 16], 'keep_empty': False}, {'type': 'Resize', 'scale': [1280, 1280], 'keep_ratio': True}, {'type': 'PackDetInputs', 'meta_keys': ['img_id', 'img_path', 'ori_shape', 'img_shape', 'scale_factor']}], 'backend_args': None, 'metainfo': {'classes': ['cow'], 'palette': [[220, 20, 60]]}}}, 'test_dataloader': {'batch_size': 5, 'num_workers': 6, 'persistent_workers': True, 'drop_last': False, 'sampler': {'type': 'DefaultSampler', 'shuffle': False}, 'dataset': {'type': 'CocoDataset', 'data_root': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/', 'ann_file': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/test_coco.json', 'data_prefix': {'img': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/test/images'}, 'test_mode': True, 'pipeline': [{'type': 'LoadImageFromFile', 'backend_args': None}, {'type': 'LoadAnnotations', 'with_bbox': True}, {'type': 'FilterAnnotations', 'min_gt_bbox_wh': [16, 16], 'keep_empty': False}, {'type': 'Resize', 'scale': [1280, 1280], 'keep_ratio': True}, {'type': 'PackDetInputs', 'meta_keys': ['img_id', 'img_path', 'ori_shape', 'img_shape', 'scale_factor']}], 'backend_args': None}}, 'val_evaluator': {'type': 'CocoMetric', 'ann_file': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch//valid_coco.json', 'metric': 'bbox', 'format_only': False, 'backend_args': None}, 'test_evaluator': {'type': 'CocoMetric', 'ann_file': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/test_coco.json', 'metric': 'bbox', 'format_only': True, 'backend_args': None, 'outfile_prefix': '/home/jaa/Work/Prog/BSU/Detectors/mmdetection/data/Padded_GroundingDINO.v1i.yolov5pytorch/test/images'}, 'default_scope': 'mmdet', 'default_hooks': {'timer': {'type': 'IterTimerHook'}, 'logger': {'type': 'LoggerHook', 'interval': 50, 'log_metric_by_epoch': True}, 'param_scheduler': {'type': 'ParamSchedulerHook'}, 'checkpoint': {'type': 'CheckpointHook', 'interval': 1}, 'sampler_seed': {'type': 'DistSamplerSeedHook'}, 'visualization': {'type': 'DetVisualizationHook'}, 'early_stopping': {'type': 'EarlyStoppingHook', 'monitor': 'coco/bbox_mAP', 'min_delta': 0.001, 'patience': 3}}, 'env_cfg': {'cudnn_benchmark': False, 'mp_cfg': {'mp_start_method': 'fork', 'opencv_num_threads': 0}, 'dist_cfg': {'backend': 'nccl'}}, 'vis_backends': [{'type': 'WandbVisBackend', 'init_kwargs': {'project': 'Сomparison of detectors', 'group': 'transformer', 'name': 'RTDETR_r50_36e_b5_New'}}], 'visualizer': {'type': 'Visualizer', 'vis_backends': [{'type': 'WandbVisBackend', 'init_kwargs': {'project': 'Сomparison of detectors', 'group': 'transformer', 'name': 'RTDETR_r50_36e_b5_New'}}], 'name': 'visualizer'}, 'log_processor': {'type': 'LogProcessor', 'window_size': 50, 'by_epoch': True}, 'log_level': 'INFO', 'load_from': '/home/jaa/Work/Prog/BSU/Detectors/models/RTDETR/rtdetr_r50vd_8xb2-72e_coco_ad2bdcfe.pth', 'resume': False, 'pretrained': '/home/jaa/Work/Prog/BSU/Detectors/models/RTDETR/resnet50vd_ssld_v2_pretrained_d037e232.pth', 'model': {'type': 'RTDETR', 'num_queries': 300, 'with_box_refine': True, 'as_two_stage': True, 'data_preprocessor': {'type': 'DetDataPreprocessor', 'batch_augments': [], 'mean': [0, 0, 0], 'std': [255, 255, 255], 'bgr_to_rgb': True, 'pad_size_divisor': 1}, 'backbone': {'type': 'ResNetV1d', 'depth': 50, 'num_stages': 4, 'out_indices': [1, 2, 3], 'frozen_stages': 0, 'norm_cfg': {'type': 'SyncBN', 'requires_grad': False}, 'norm_eval': True, 'style': 'pytorch', 'init_cfg': {'type': 'Pretrained', 'checkpoint': 'https://github.com/flytocc/mmdetection/releases/download/model_zoo/resnet50vd_ssld_v2_pretrained_d037e232.pth'}}, 'neck': {'type': 'ChannelMapper', 'in_channels': [512, 1024, 2048], 'kernel_size': 1, 'out_channels': 256, 'act_cfg': None, 'norm_cfg': {'type': 'SyncBN', 'requires_grad': True}, 'num_outs': 3}, 'encoder': {'use_encoder_idx': [2], 'num_encoder_layers': 1, 'in_channels': [256, 256, 256], 'fpn_cfg': {'type': 'RTDETRFPN', 'in_channels': [256, 256, 256], 'out_channels': 256, 'expansion': 1.0, 'norm_cfg': {'type': 'SyncBN', 'requires_grad': True}}, 'layer_cfg': {'self_attn_cfg': {'embed_dims': 256, 'num_heads': 8, 'dropout': 0.0}, 'ffn_cfg': {'embed_dims': 256, 'feedforward_channels': 1024, 'ffn_drop': 0.0, 'act_cfg': {'type': 'GELU'}}}}, 'decoder': {'num_layers': 6, 'return_intermediate': True, 'layer_cfg': {'self_attn_cfg': {'embed_dims': 256, 'num_heads': 8, 'dropout': 0.0}, 'cross_attn_cfg': {'embed_dims': 256, 'num_levels': 3, 'dropout': 0.0}, 'ffn_cfg': {'embed_dims': 256, 'feedforward_channels': 1024, 'ffn_drop': 0.0}}, 'post_norm_cfg': None}, 'bbox_head': {'type': 'RTDETRHead', 'num_classes': 1, 'sync_cls_avg_factor': True, 'loss_cls': {'type': 'RTDETRVarifocalLoss', 'use_sigmoid': True, 'alpha': 0.75, 'gamma': 2.0, 'iou_weighted': True, 'loss_weight': 1.0}, 'loss_bbox': {'type': 'L1Loss', 'loss_weight': 5.0}, 'loss_iou': {'type': 'GIoULoss', 'loss_weight': 2.0}}, 'dn_cfg': {'label_noise_scale': 0.5, 'box_noise_scale': 1.0, 'group_cfg': {'dynamic': True, 'num_groups': None, 'num_dn_queries': 100}}, 'train_cfg': {'assigner': {'type': 'HungarianAssigner', 'match_costs': [{'type': 'FocalLossCost', 'weight': 2.0}, {'type': 'BBoxL1Cost', 'weight': 5.0, 'box_format': 'xywh'}, {'type': 'IoUCost', 'iou_mode': 'giou', 'weight': 2.0}]}}, 'test_cfg': {'max_per_img': 300}}, 'interpolations': ['nearest', 'bilinear', 'bicubic', 'area', 'lanczos'], 'optim_wrapper': {'type': 'OptimWrapper', 'optimizer': {'type': 'AdamW', 'lr': 1e-06, 'weight_decay': 0.05}, 'clip_grad': {'max_norm': 0.1, 'norm_type': 2}, 'paramwise_cfg': {'custom_keys': {'backbone': {'lr_mult': 0.1}}, 'norm_decay_mult': 0, 'bypass_duplicate': True}, 'accumulative_counts': 3}, 'max_epochs': 72, 'train_cfg': {'type': 'EpochBasedTrainLoop', 'max_epochs': 36, 'val_interval': 1}, 'val_cfg': {'type': 'ValLoop'}, 'test_cfg': {'type': 'TestLoop'}, 'param_scheduler': [{'type': 'LinearLR', 'start_factor': 1e-05, 'by_epoch': True, 'begin': 0, 'end': 2}, {'type': 'CosineAnnealingLR', 'eta_min': 0.0, 'by_epoch': True, 'begin': 9, 'end': 36, 'T_max': 27}], 'auto_scale_lr': {'base_batch_size': 5, 'enable': False}, 'custom_hooks': [{'type': 'CustomFreezeHook', 'unfreeze_epoch': 5}], 'custom_imports': {'imports': ['mmdet.models.detectors.rtdetr', 'custom_freeze_hook'], 'allow_failed_imports': False}, 'seed': 42, 'deterministic': True, 'HOME': '/home/jaa/Work/Prog/BSU/Detectors', 'evaluation': {'interval': 1, 'metric': 'bbox'}, 'image_size': [1280, 1280], 'num_workers': 6, 'num_classes': 1, 'MODEL_GROUP': 'transformer', 'MODEL_TYPE': 'RTDETR', 'WEIGHT_SIZE': 'r50', 'weights': 'rtdetr_r50vd_8xb2-72e_coco_ad2bdcfe.pth', 'checkpoint_config': {'interval': 1}, 'batch_size': 5, 'num_epochs': 36, 'additions': 'New', 'experiment': 'RTDETR_r50_36e_5b_New_custom', 'work_dir': '/home/jaa/Work/Prog/BSU/Detectors/work_dirs/RTDETR/RTDETR_r50_36e_5b_New_custom/', 'metainfo': {'classes': ['cow'], 'palette': [[220, 20, 60]]}, 'launcher': 'none'}
2025-05-15 04:45:06,509 INFO    MainThread:128635 [wandb_run.py:_finish():2189] finishing run jigaloff-belgorod-state-university/Сomparison of detectors/g3hlkuf7
2025-05-15 04:45:06,511 INFO    MainThread:128635 [wandb_run.py:_atexit_cleanup():2419] got exitcode: 0
2025-05-15 04:45:06,511 INFO    MainThread:128635 [wandb_run.py:_restore():2401] restore
2025-05-15 04:45:06,511 INFO    MainThread:128635 [wandb_run.py:_restore():2407] restore done
2025-05-15 04:45:09,789 INFO    MainThread:128635 [wandb_run.py:_footer_history_summary_info():4064] rendering history
2025-05-15 04:45:09,790 INFO    MainThread:128635 [wandb_run.py:_footer_history_summary_info():4096] rendering summary
2025-05-15 04:45:09,790 INFO    MainThread:128635 [wandb_run.py:_footer_sync_info():4025] logging synced files
